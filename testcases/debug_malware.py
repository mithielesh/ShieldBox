#!/usr/bin/env python3
"""
Debug malware detection by analyzing what keywords are found
"""

# Test malware email content
malware_email_1 = {
    "subject": "Important Document - Please Review",
    "body": "Please download and run this important document.exe file immediately. It contains critical information for your computer."
}

malware_email_2 = {
    "subject": "Download Your Free Software Now!",
    "body": "Download our free software! Click here to install: https://virus-software.com/download/malware.exe Warning: disable antivirus first."
}

malware_keywords = [
    'download and run', 'execute file', 'disable antivirus', 'install now',
    'document.exe', 'urgent.exe', 'invoice.exe', 'report.exe', '.exe',
    'free software', 'software download', 'crack', 'keygen', 'activation',
    'virus', 'malware', 'trojan', 'suspicious-domain', 'suspicious domain'
]

print("MALWARE KEYWORD DETECTION DEBUG")
print("=" * 50)

for i, email in enumerate([malware_email_1, malware_email_2], 1):
    print(f"\nTesting Malware Email {i}:")
    print(f"Subject: {email['subject']}")
    print(f"Body: {email['body']}")
    
    text_to_check = (email['subject'] + " " + email['body']).lower()
    print(f"Text to check: {text_to_check}")
    
    found_keywords = []
    for keyword in malware_keywords:
        if keyword in text_to_check:
            found_keywords.append(keyword)
    
    print(f"Keywords found: {found_keywords}")
    print(f"Total malware indicators: {len(found_keywords)}")
    
    if len(found_keywords) >= 1:
        print("✅ Should be detected as malware")
    else:
        print("❌ Will NOT be detected as malware")
    
    print("-" * 40)
